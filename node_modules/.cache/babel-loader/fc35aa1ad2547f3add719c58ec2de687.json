{"ast":null,"code":"var _jsxFileName = \"/home/saahil/Desktop/SE-Project/cometchatsdk/my-app/src/Client.js\";\nimport React, { Component } from 'react';\nimport { Widget, addResponseMessage, launcher, addUserMessage, dropMessages } from 'react-chat-widget'; //import config from './config';\n\nimport 'react-chat-widget/lib/styles.css'; //to get the style of it \n\nimport { get } from 'https'; //import { createSecureServer } from 'http2';\n\nvar messageID = 0;\n\nvar request = require(\"request\");\n\nconst appid = '11117c8bb5adb87';\nconst apikey = '3244e1da16d747391d68a8e5c6a75a25ab8458c1';\nconst agentUID = 'agent-trial-4';\nconst customerUID = 'client-trial-4'; //const CUSTOMER_MESSAGE_LISTENER_KEY = \"client-listener\";\n\nconst limit = 30;\n\nclass Client extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.handleNewUserMessage = newMessage => {\n      console.log(\"New message incomig! \".concat(newMessage)); // Now send the message throught the backend API\n\n      console.log(newMessage);\n      this.sendmessage(agentUID, customerUID, newMessage);\n      var result = dropMessages();\n      console.log(result);\n      console.log(\"there is a return type in dropmessage\");\n      this.getconversation(agentUID, customerUID, 0); //this.messageListener((agentUID,customerUID,newMessage));\n      // create listener\n      //this.getconversation(agentUID,customerUID);\n    };\n\n    this.createuser = function (UID, role) {\n      var options = {\n        method: 'POST',\n        url: 'https://api-eu.cometchat.io/v2.0/users',\n        headers: {\n          appid: '11117c8bb5adb87',\n          apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n          'content-type': 'application/json',\n          accept: 'application/json'\n        },\n        body: '{\"uid\":' + '\"' + String(UID) + '\"' + ',\"name\":\"client\",\"role\":' + '\"' + String(role) + '\"' + ',\"withAuthToken\":true}'\n      };\n      console.log(\"create user\", options.body);\n      request(options, function (error, response, body) {\n        if (error) throw new Error(error);\n        console.log(response); //return response;\n      });\n    };\n\n    this.sendmessage = function (agentUID, customerUID, newMessage) {\n      var options = {\n        method: 'POST',\n        url: 'https://api-eu.cometchat.io/v2.0/users/' + String(customerUID) + '/messages',\n        headers: {\n          appid: '11117c8bb5adb87',\n          apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n          'content-type': 'application/json',\n          accept: 'application/json'\n        },\n        body: '{\"receiver\":' + '\"' + String(agentUID) + '\"' + ',\"receiverType\":\"user\",\"category\":\"message\",\"type\":\"text\",\"data\":{\"text\":' + '\"' + String(newMessage) + '\"' + '}}'\n      };\n      request(options, function (error, response, body) {\n        if (error) throw new Error(error);\n        console.log(body);\n      });\n    };\n\n    this.getconversation = function (agentUID, customerUID, flag = 0) {\n      var options = {\n        method: 'GET',\n        url: 'https://api-eu.cometchat.io/v2.0/users/' + String(agentUID) + '/users/' + String(customerUID) + '/messages',\n        //qs: {unread: 'true', undelivered: 'true'},\n        headers: {\n          appid: '11117c8bb5adb87',\n          apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n          'content-type': 'application/json',\n          accept: 'application/json'\n        }\n      };\n      request(options, function (error, response, body) {\n        if (error) throw new Error(error);\n        var j = JSON.parse(response[\"body\"]);\n        console.log(j);\n        j = j[\"data\"];\n\n        if (j.length === 0) {\n          return;\n        }\n\n        var x;\n        console.log(j[0]);\n\n        if (flag) {\n          for (x in j) {\n            //console.log(\"x in j\",j[x].data.text);\n            if (j[x].receiver === agentUID) {\n              addUserMessage(String(j[x].data.text));\n            } else {\n              console.log(\"found\");\n              addResponseMessage(String(j[x].data.text));\n            }\n          }\n        } //messageID+=j[x].id\n\n\n        console.log(\"obj\", j[0].data.text);\n        console.log(typeof j);\n      });\n    };\n\n    this.messageListener = function () {\n      dropMessages();\n      this.getconversation(agentUID, customerUID, 0);\n      var options = {\n        method: 'GET',\n        url: 'https://api-eu.cometchat.io/v2.0/users/' + String(agentUID) + '/users/' + String(customerUID) + '/messages',\n        qs: {\n          unread: 'true',\n          undelivered: 'true',\n          id: '\\'' + messageID + '\\''\n        },\n        headers: {\n          appid: '11117c8bb5adb87',\n          apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n          'content-type': 'application/json',\n          accept: 'application/json'\n        }\n      };\n      console.log(options);\n      console.log(\"messagelistener\");\n      request(options, function (error, response, body) {\n        if (error) throw new Error(error);\n        console.log(body);\n      });\n    };\n  }\n\n  componentDidMount() {\n    addResponseMessage('You are now chatting with your broker ');\n    addResponseMessage('Do not share sensitive data with the broker');\n    console.log(\"your an client\");\n    let uid = localStorage.getItem(customerUID);\n    let uidb = localStorage.getItem(agentUID);\n    this.createuser(customerUID, 'customer'); //for customer \n\n    uid = localStorage.setItem(\"cc-uid\", customerUID);\n    this.createuser(agentUID, 'agent'); //for broker\n\n    uidb = localStorage.setItem(\"cc-uid\", agentUID);\n    var flag2 = 1;\n    console.log(\"messageListener\"); //this.messageListener(agentUID,customerUID)\n\n    {\n      {// if (uid === null) {\n        //   this.createuser(customerUID,'customer');//for customer \n        //   localStorage.setItem(\"cc-uid\",customerUID)\n        //   flag2=0\n        // }\n        // if(uidb===null)\n        // {\n        //   this.createuser(agentUID,'agent');//for broker\n        //   localStorage.setItem(\"cc-uid\",agentUID)\n        //   flag2=0\n        // }\n      }\n      var flag = 1;\n      {\n        console.log();\n\n        if (flag2) {\n          console.log(\"conversation being called\");\n          this.getconversation(agentUID, customerUID, 1);\n          this.messageListener(agentUID, customerUID, flag = 0);\n        }\n      }\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(Widget, {\n      messageListener: this.messageListener,\n      handleNewUserMessage: this.handleNewUserMessage,\n      title: \"Broker-Chat\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Client;","map":{"version":3,"sources":["/home/saahil/Desktop/SE-Project/cometchatsdk/my-app/src/Client.js"],"names":["React","Component","Widget","addResponseMessage","launcher","addUserMessage","dropMessages","get","messageID","request","require","appid","apikey","agentUID","customerUID","limit","Client","handleNewUserMessage","newMessage","console","log","sendmessage","result","getconversation","createuser","UID","role","options","method","url","headers","accept","body","String","error","response","Error","flag","j","JSON","parse","length","x","receiver","data","text","messageListener","qs","unread","undelivered","id","componentDidMount","uid","localStorage","getItem","uidb","setItem","flag2","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Widget, addResponseMessage,launcher, addUserMessage, dropMessages } from 'react-chat-widget';\n//import config from './config';\nimport 'react-chat-widget/lib/styles.css';//to get the style of it \nimport { get } from 'https';\n//import { createSecureServer } from 'http2';\n\nvar messageID=0;\n\nvar request = require(\"request\");\n\nconst appid='11117c8bb5adb87';\nconst apikey='3244e1da16d747391d68a8e5c6a75a25ab8458c1';\n\n\nconst agentUID = 'agent-trial-4';\nconst customerUID='client-trial-4';\n\n//const CUSTOMER_MESSAGE_LISTENER_KEY = \"client-listener\";\nconst limit = 30;\nclass Client extends Component {\n  componentDidMount() {\n    addResponseMessage('You are now chatting with your broker ');\n    addResponseMessage('Do not share sensitive data with the broker');\n    console.log(\"your an client\");\n    let uid = localStorage.getItem(customerUID);\n    let uidb=localStorage.getItem(agentUID);\n\n    this.createuser(customerUID,'customer');//for customer \n    uid=localStorage.setItem(\"cc-uid\",customerUID)\n     \n      this.createuser(agentUID,'agent');//for broker\n      uidb=localStorage.setItem(\"cc-uid\",agentUID)  ;\n    var flag2=1;\n    console.log(\"messageListener\")\n    //this.messageListener(agentUID,customerUID)\n    {\n      {\n    // if (uid === null) {\n     \n    //   this.createuser(customerUID,'customer');//for customer \n    //   localStorage.setItem(\"cc-uid\",customerUID)\n    //   flag2=0\n    // }\n    // if(uidb===null)\n    // {\n    //   this.createuser(agentUID,'agent');//for broker\n    //   localStorage.setItem(\"cc-uid\",agentUID)\n    //   flag2=0\n    // }\n      }\n    var flag=1;\n    { console.log()\n    if(flag2)\n    {console.log(\"conversation being called\")\n      this.getconversation(agentUID,customerUID,1)\n      this.messageListener(agentUID,customerUID,flag=0)\n    }\n\n    }}\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Widget\n      messageListener={this.messageListener}\n          handleNewUserMessage={this.handleNewUserMessage}\n          title='Broker-Chat'\n          \n\n        />\n      </div>\n    );\n  }\n\n  handleNewUserMessage = (newMessage) => {\n    \n    console.log(`New message incomig! ${newMessage}`);\n    // Now send the message throught the backend API\n    console.log(newMessage);\n    this.sendmessage(agentUID,customerUID,newMessage);\n    var result=dropMessages();\n    console.log(result)\n    console.log(\"there is a return type in dropmessage\")\n    this.getconversation(agentUID,customerUID,0);\n    //this.messageListener((agentUID,customerUID,newMessage));\n    // create listener\n    //this.getconversation(agentUID,customerUID);\n    \n\n  };\n\ncreateuser = function (UID,role){\n\n\n  var options = {\n    method: 'POST',\n    url: 'https://api-eu.cometchat.io/v2.0/users',\n    headers: {\n      appid: '11117c8bb5adb87',\n      apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n      'content-type': 'application/json',\n      accept: 'application/json'\n    },\n    body: '{\"uid\":'+'\"'+String(UID)+'\"'+',\"name\":\"client\",\"role\":'+'\"'+String(role)+'\"'+',\"withAuthToken\":true}'\n    \n  };\n  console.log(\"create user\",options.body)\n  \n  request(options, function (error, response, body) {\n    if (error) throw new Error(error);\n    console.log(response);\n    //return response;\n    \n  });  \n\n\n}\n\nsendmessage=function (agentUID,customerUID,newMessage) {\n  var options = {\n    method: 'POST',\n    url: 'https://api-eu.cometchat.io/v2.0/users/'+String(customerUID)+'/messages',\n    headers: {\n      appid: '11117c8bb5adb87',\n      apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n      'content-type': 'application/json',\n      accept: 'application/json'\n    },\n    body: '{\"receiver\":'+'\"'+String(agentUID)+'\"'+',\"receiverType\":\"user\",\"category\":\"message\",\"type\":\"text\",\"data\":{\"text\":'+'\"'+String(newMessage)+'\"'+'}}'\n};\n  request(options, function (error, response, body) {\n    if (error) throw new Error(error);\n  \n    console.log(body);\n  });\n}\n//get user messages\ngetconversation=function (agentUID,customerUID,flag=0) {\n  var options = {\n    method: 'GET',\n    url: 'https://api-eu.cometchat.io/v2.0/users/'+String(agentUID)+'/users/'+String(customerUID)+'/messages',\n    //qs: {unread: 'true', undelivered: 'true'},\n    headers: {\n      appid: '11117c8bb5adb87',\n      apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n      'content-type': 'application/json',\n      accept: 'application/json'\n    }\n  };\n  \n  request(options, function (error, response, body) {\n    if (error) throw new Error(error);    \n    var j=JSON.parse(response[\"body\"])\n    console.log(j)\n    j=j[\"data\"]\n    if(j.length===0){return }\n    var x\n    console.log(j[0])\n    if(flag){\n    for(x in j){\n      //console.log(\"x in j\",j[x].data.text);\n      if(j[x].receiver===agentUID){\n      addUserMessage(String(j[x].data.text));}\n      else{\n        console.log(\"found\")\n        addResponseMessage((String(j[x].data.text)))\n      }\n      \n    }\n  }\n  //messageID+=j[x].id\n\n    console.log(\"obj\",j[0].data.text);\n    console.log(typeof(j))\n  });\n}\n  messageListener=function () {\n  dropMessages()\n    this.getconversation(agentUID,customerUID,0)\n    var options = {\n      method: 'GET',\n      url: 'https://api-eu.cometchat.io/v2.0/users/'+String(agentUID)+'/users/'+String(customerUID)+'/messages',\n      qs: {unread: 'true', undelivered: 'true', id: '\\'' + messageID + '\\''},\n      headers: {\n        appid: '11117c8bb5adb87',\n        apikey: '3244e1da16d747391d68a8e5c6a75a25ab8458c1',\n        'content-type': 'application/json',\n        accept: 'application/json'\n      }\n    };\n    console.log(options);\n    console.log(\"messagelistener\")\n    request(options, function (error, response, body) {\n      if (error) throw new Error(error);\n    \n      console.log(body);\n    });\n\n\n\n  }\n}\nexport default Client;"]},"metadata":{},"sourceType":"module"}